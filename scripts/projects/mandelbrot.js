(()=>{function t(t){return t&&t.__esModule?t.default:t}function e(t,e,o,i=!0){colorMode(HSB);let n,l,r=hue(t),s=hue(e);i?(n=s>r?s-r:360-r+s,l=r+n*o,l>360&&(l-=360)):(n=s>r?r+(360-s):r-s,l=r-n*o,l<=0&&(l=360+l));let a=saturation(t),c=a+(saturation(e)-a)*o,p=brightness(t),d=brightness(e);return color(l,c,p+(d-p)*o)}let o,i,n,l,r,s,a,c,p,d,h,u,m=document.createElement("style");m.textContent=t('.tooltip-btn{color:#19191d;z-index:0;background:#fff;border:2px solid #2d2d39;font-size:1rem;font-weight:600;position:absolute;top:0;left:0}.tooltip-btn.right{left:auto;right:0}.tooltip-btn:hover,.tooltip-btn:focus{color:#fff;background:#19191d;border:2px solid #fff}.tooltip{z-index:1;width:250px;min-height:100px;background:#fff;padding:6px 10px;font-size:.9rem;display:none;position:absolute;top:0;left:0}.tooltip.right{left:auto;right:0}.tooltip table{width:100%;font-size:.9rem}.tooltip h2.tooltip-title{border-bottom:1px solid #586666;margin:0;font-size:1.2rem;font-weight:500}.tooltip p,.tooltip h1,.tooltip h2,.tooltip h3{margin:0;line-height:1.2}.tooltip.active{display:block}.tooltip .note{margin:5px 0 0;font-size:.8rem}.tooltip .tooltip-close{width:20px;height:20px;color:#19191d;background-color:#0000;border:none;padding:0;font-weight:800;position:absolute;top:3px;right:3px}.tooltip .tooltip-close:before,.tooltip .tooltip-close:after{content:"";width:15px;height:3px;background:#2d2d39;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)rotate(-45deg)}.tooltip .tooltip-close:after{transform:translate(-50%,-50%)rotate(45deg)}.tooltip .tooltip-close:hover,.tooltip .tooltip-close:focus{background:#32de8a}'),document.body.appendChild(m);class f{constructor({tipContentBlock:t,titleString:e,tipContent:o,btnName:i,note:n,right:l=!1,startOpen:r=!1}){this.btn,this.closeBtn,this.tip=createDiv().class(l?"tooltip right":"tooltip "),this.buildButtons(i,l),this.title=createElement("h2",e).parent(this.tip).class("tooltip-title"),this.contentBlock=t?t.parent(this.tip):createDiv().parent(this.tip),o&&this.buildTable(o),n&&this.addNote(n),r&&this.openTooltip()}buildButtons(t,e){this.btn=createButton(t??"controls").class(e?"tooltip-btn right":"tooltip-btn"),this.closeBtn=createButton("").parent(this.tip).class("tooltip-close").attribute("aria-label","close tooltip"),this.btn.elt.addEventListener("click",(()=>this.openTooltip())),this.closeBtn.elt.addEventListener("click",(()=>this.closeTooltip()))}buildTable(t){let e=createElement("table").parent(this.contentBlock);t.forEach((t=>{let o=createElement("tr").parent(e);createElement("th",t[0]).parent(o).attribute("scope","row"),createElement("td",t[1]).parent(o)}))}addNote(t){createP(t).parent(this.contentBlock).class("note")}openTooltip(){this.tip.addClass("active"),this.btn.attribute("aria-expanded","true"),this.closeBtn.elt.focus()}closeTooltip(){this.tip.removeClass("active"),this.btn.elt.focus(),this.btn.attribute("aria-expanded","false")}}let b=document.querySelector(".info-container"),g={cx:-1.15,cy:.21,zoom:1,iterations:50};const x=700,w=550,y=2,k=!1;let z=!1,v=!1;function C(){d=[[random(0,360),92,54],[random(0,360),98,99],[random(0,360),92,54]]}function B(){console.log("start make fractals"),v=!0,console.time("calculating"),function(){colorMode(HSB);let t=[],o=0,i=g.iterations/4;for(;o<i;){let n=e(color(d[0]),color(d[1]),o/i);t.push([red(n),green(n),blue(n)]),o++}for(;o<=g.iterations;){let n=e(color(d[1]),color(d[2]),map(o,i,g.iterations,0,1));t.push([red(n),green(n),blue(n)]),o++}p=t}(),o=[-n*(1/g.zoom)+g.cx,n*(1/g.zoom)+g.cx],i=[-l*(1/g.zoom)+g.cy,l*(1/g.zoom)+g.cy],resizeCanvas(x*y,w*y),pixelDensity(1),loadPixels();for(let t=0;t<height;t++)for(let e=0;e<width;e++){let n=map(e,0,width,o[0],o[1]),l=map(t,0,height,i[0],i[1]),r=createVector(n,l),s=createVector(0,0),a=0;for(;a<g.iterations;){let t=s.x*s.x-s.y*s.y+r.x,e=s.x*s.y*2+r.y;if(t*t+e*e>4)break;s.x=t,s.y=e,a++}let c=4*(e+t*width),d=a/g.iterations;k?(d*=255,pixels[c]=d,pixels[c+1]=d,pixels[c+2]=d,pixels[c+3]=255):(pixels[c]=p[a][0],pixels[c+1]=p[a][1],pixels[c+2]=p[a][2],pixels[c+3]=255)}updatePixels(),c=get(),resizeCanvas(x,w),pixelDensity(y),console.timeEnd("calculating"),z=!0,v=!1,h.innerHTML=`center: ${round(g.cx,5)}, ${round(g.cy,5)} <br/> zoom: ${g.zoom} <br/>iterations: ${g.iterations}`}window.setup=function(){u=createCanvas(x*y,w*y),u.parent("canvas"),drawingContext.willReadFrequently=!0,noSmooth(),h=document.createElement("pre"),b.appendChild(h),h.setAttribute("style","margin-left: 20px"),n=1.8,r=n/width,l=height*r,C(),new f({titleString:"controls",btnName:"keys",tipContent:[["m","iterations+=20"],["n","iterations-=20"],["ArrowUp","zoom in"],["ArrowDown","zoom out"],["click","choose center"],["c","new colors"],["s","save"]],right:!0,startOpen:!0}),u.mousePressed((()=>{mouseX>width||mouseY>height||v||v||(g.cx=map(mouseX,0,width,o[0],o[1]),g.cy=map(mouseY,0,height,i[0],i[1]),z=!1)})),B()},window.draw=function(){z&&!v&&c?(image(c,0,0,x,w),fill(255,0,255),circle(mouseX,mouseY,5),s=map(mouseX,0,width,o[0],o[1]),a=map(mouseY,0,height,i[0],i[1])):z||v||B()},window.keyTyped=function(){v||("m"===key?(g.iterations+=20,z=!1):"n"===key?(g.iterations-=20,z=!1):"s"===key?saveCanvas("mandelbrot","jpg"):"c"===key&&(C(),z=!1))},window.keyPressed=function(){v||(keyCode===UP_ARROW?(g.zoom*=g.zoom<=10?2:5,z=!1):keyCode===DOWN_ARROW&&(g.zoom/=g.zoom<=10?2:5,z=!1))}})();
//# sourceMappingURL=mandelbrot.js.map
